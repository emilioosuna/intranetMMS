CREATE TABLE IF NOT EXISTS TEMP_FACT_ASESOR
(
 CANTIDADF SMALLINT DESCRIPTION 'CANTIDADF',
 CODASESOR CHAR(10) DESCRIPTION 'CODASESOR',
 ASESOR CHAR(100) DESCRIPTION 'ASESOR',
 FACTURA CHAR(8) DESCRIPTION 'FACTURA',
);
DELETE FROM TEMP_FACT_ASESOR;
INSERT INTO TEMP_FACT_ASESOR
SELECT IF(COUNT(FDI.FDI_VENDEDORASIGNADO)>1,COUNT(FDI.FDI_VENDEDORASIGNADO)-COUNT(FDI.FDI_CODIGO)+1, COUNT(FDI.FDI_VENDEDORASIGNADO))AS CANTIDAD, FV.FV_CODIGO,
FV.FV_DESCRIPCION AS ASESOR, FDI.FDI_DOCUMENTO 
FROM SDETALLEVENTA FDI INNER JOIN SVENDEDORES FV ON FV.FV_CODIGO = FDI.FDI_VENDEDORASIGNADO
WHERE FDI.FDI_FECHAOPERACION BETWEEN '2024-01-02' AND '2024-01-02' AND FDI.FDI_TIPOOPERACION = 11
GROUP BY FDI.FDI_DOCUMENTO, FV.FV_DESCRIPCION
ORDER BY FV.FV_CODIGO;
SELECT SUM(CANTIDADF) AS TOTALXASESOR, ASESOR
FROM TEMP_FACT_ASESOR
GROUP BY ASESOR
ORDER BY 1 DESC;